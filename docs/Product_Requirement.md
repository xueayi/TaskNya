# **项目需求文档：任务监测与系统健康可视化工具**

## **1. 项目概述**
### **1.1 项目目标**
本项目旨在开发一个用于 **监测用户任务** 和 **系统健康状态** 的 Web 工具，支持 Linux 和 Windows 系统。主要功能包括：
1. **任务监测**：实时跟踪用户任务的进度、错误状态和完成情况，并进行提醒。
2. **系统健康监测**：监测 CPU、内存、磁盘、网络、温度等关键指标，并在异常情况下发送警报。
3. **可视化展示**：提供 Web 界面，通过图表和仪表盘展示任务状态和系统健康情况。
4. **多端兼容**：支持在 Docker 容器中运行，同时兼容 Linux 和 Windows 服务器。
5. **GUI 界面支持**：支持 Web GUI 配置参数、创建任务、预设任务，并可视化系统任务参数、进度信息和系统状态信息。

### **1.2 适用场景**
- 运行深度学习、数据分析、任务调度等计算任务的用户。
- 需要远程监控服务器状态的开发者或运维人员。
- 需要实时监控 GPU 资源、日志文件和异常情况的科研工作者。
- 适用于不同 GPU 环境，包括 NVIDIA、AMD、核显 等。

---

## **2. 核心功能**
### **2.1 任务监测模块**
- **任务状态监测**：检测任务进度，包括执行时间、进程状态、资源占用。
- **任务完成提醒**：基于生成文件、日志关键词、GPU 资源等方式检测任务完成情况，任务结束后自动推送通知。
- **日志分析**：监测任务日志文件，识别异常（如 OOM、CUDA 错误、崩溃）。
- **日志统一编码格式**：确保日志文件按照 UTF-8 编码方式存储，提升兼容性。
- **资源占用监测**：跟踪任务对 CPU、GPU、内存的使用情况。
- **任务超时检测**：如果任务长时间无响应，自动触发告警。
- **完善触发检测条件**：支持更多可选触发条件判断任务完成。

### **2.2 系统健康监测模块**
- **CPU 监测**：使用率、温度、异常负载报警。
- **内存监测**：使用情况、可用内存、是否发生内存泄漏。
- **磁盘监测**：存储空间占用率、I/O 速率、硬盘健康状态（SMART）。
- **网络监测**：实时带宽占用情况、端口状态、远程连接情况。
- **温度与风扇监测**（Linux）：监测 GPU、CPU 温度和风扇转速。
- **Windows 兼容性**：支持 Windows 任务管理器数据获取（CPU、内存、磁盘等）。
- **多 GPU 兼容性**：支持不同品牌 GPU 监测（NVIDIA、AMD、核显 等）。

### **2.3 报警与通知模块**
- **异常报警**：当任务异常或系统资源超限时，自动触发告警。
- **通知方式**：支持webhook、邮件、微信、Telegram、企业微信等通知方式。
- **企业微信推送支持**：集成企业微信 API 进行通知推送。
- **历史告警记录**：存储告警历史，方便查询和分析。

### **2.4 可视化展示模块**
- **Web GUI 界面**：支持用户通过 GUI 进行参数配置、任务管理和状态监测。
- **任务状态仪表盘**：以表格、进度条等形式展示当前任务状态。
- **系统资源监控图表**：CPU、内存、GPU、磁盘、网络的历史曲线与实时监控。
- **异常统计分析**：展示过往错误日志，分析常见问题。

---

## **3. 技术方案**
### **3.1 后端**
- **语言**：Python
- **框架**：Flask 或 FastAPI（提供 API 接口）
- **任务监测**：使用 `psutil` 监控进程和系统资源
- **日志监测**：基于 `watchdog` 监听任务日志变化
- **日志编码格式**：日志存储采用 UTF-8 以提升跨平台兼容性。
- **GPU 监测**：调用 `nvidia-smi` 获取 GPU 使用情况，并适配 AMD 显卡、核显监测方案。
- **数据库**：SQLite / PostgreSQL / InfluxDB（存储监测数据）

### **3.2 前端**
- **框架**：React / Vue.js（构建动态仪表盘）
- **数据可视化**：ECharts / Chart.js / D3.js
- **界面框架**：Bootstrap / Tailwind CSS

### **3.3 任务执行与日志管理**
- **任务调度**：Celery / Systemd 定时任务
- **日志存储**：Elasticsearch / Graylog
- **实时推送**：WebSocket / SSE
- **邮件推送支持**：支持 SMTP 协议进行邮件通知推送。

### **3.4 Docker 兼容性**
- **运行方式**：提供 Docker 镜像，支持 Linux / Windows
- **文件访问**：使用 Docker Volume 共享宿主机日志和任务文件
- **端口映射**：支持 HTTP API 访问（默认端口 15000）
- **创建 Docker 容器**：提供 Dockerfile 及相关部署脚本。

---

## **4. 部署方案**
### **4.1 本地运行（开发环境）**

- 安装依赖
- 运行应用


### **4.2 Docker 运行**

- 构建镜像
- 运行容器

### **4.3 服务器部署（Nginx + Supervisor）**
- 使用 **Nginx 反向代理** 提供 Web 访问。
- 通过 **Supervisor / Systemd** 维持 Flask 进程。
- 使用 **定时任务** 自动清理过期日志。

---

## **5. 结论**
本项目旨在打造一个 **高效、可视化、可扩展** 的任务监测与系统健康管理工具。它不仅可以 **监测任务状态**，还可以 **检测服务器健康状况**，并在异常时 **主动告警**。后续可以进一步扩展 **多用户管理、AI 预测异常、远程控制任务** 等高级功能。

